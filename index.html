<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>××•×¢×“×•×Ÿ ×¤××“×œ â€“ ×”×¨×©××”</title>
<link rel="preconnect" href="https://fonts.googleapis.com"/>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Frank+Ruhl+Libre:wght@300;400;500;700&display=swap" rel="stylesheet"/>
<style>
:root{
  --gold:#f59e0b;--gold2:#d97706;--gold3:#fde68a;
  --blue3:#3b82f6;--blue4:#60a5fa;
  --bg:#07090f;--bg2:#0f1623;--bg3:#172035;--bg4:#1e2d4a;
  --bd:#1e3a5f;--tx:#e8f0fe;--tx2:#7b9abf;
}
*{box-sizing:border-box;margin:0;padding:0}
html,body{direction:rtl;text-align:right}
body{background:var(--bg);color:var(--tx);font-family:'Frank Ruhl Libre',serif;min-height:100vh}
h1,h2{font-family:'Bebas Neue',sans-serif;letter-spacing:.04em}
.app{max-width:700px;margin:0 auto;padding:24px 16px 80px}

nav{display:flex;align-items:center;justify-content:space-between;padding:14px 28px;
  background:linear-gradient(90deg,var(--bg3),var(--bg2));
  border-bottom:1px solid var(--bd);position:sticky;top:0;z-index:100;backdrop-filter:blur(10px)}
.nav-brand{font-family:'Bebas Neue',sans-serif;font-size:1.7rem;
  background:linear-gradient(135deg,var(--gold),var(--gold3));
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;letter-spacing:.12em}

.card{background:linear-gradient(145deg,var(--bg2),var(--bg3));border:1px solid var(--bd);
  border-radius:14px;padding:24px;margin-bottom:20px;box-shadow:0 4px 24px rgba(0,0,0,.4)}
.card-title{font-family:'Bebas Neue',sans-serif;font-size:1.3rem;letter-spacing:.08em;
  margin-bottom:18px;display:flex;align-items:center;gap:8px}
.card-title-text{background:linear-gradient(90deg,var(--gold),var(--gold3));
  -webkit-background-clip:text;-webkit-text-fill-color:transparent}
.card-title-bar{width:3px;min-height:1.2em;align-self:stretch;
  background:linear-gradient(180deg,var(--gold),var(--gold2));border-radius:2px;flex-shrink:0}

.field-label{display:block;font-size:.78rem;font-weight:700;color:var(--tx2);
  text-transform:uppercase;letter-spacing:.1em;margin-bottom:6px}
input[type=text],input[type=tel]{width:100%;background:var(--bg4);border:1.5px solid var(--bd);
  border-radius:10px;padding:11px 16px;color:var(--tx);font-family:'Frank Ruhl Libre',serif;
  font-size:.95rem;outline:none;transition:border .2s;direction:rtl}
input[type=text]:focus,input[type=tel]:focus{border-color:var(--gold)}
.form-group{margin-bottom:18px}
.field-error{color:#f87171;font-size:.75rem;margin-top:4px;display:none}
.field-error.show{display:block}

/* Skill slider */
.skill-slider-wrap{margin-top:6px}
.skill-slider{-webkit-appearance:none;appearance:none;width:100%;height:6px;
  border-radius:4px;outline:none;cursor:pointer;direction:ltr}
.skill-slider::-webkit-slider-thumb{-webkit-appearance:none;width:22px;height:22px;
  border-radius:50%;background:linear-gradient(135deg,var(--gold),var(--gold2));
  border:3px solid var(--bg);box-shadow:0 0 0 2px var(--gold2);cursor:pointer;transition:transform .15s}
.skill-slider::-webkit-slider-thumb:hover{transform:scale(1.15)}
.skill-display{display:flex;align-items:center;gap:12px;margin-top:10px}
.skill-value{font-size:2.2rem;font-family:'Bebas Neue',sans-serif;
  background:linear-gradient(135deg,var(--gold),var(--gold3));
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;line-height:1;min-width:62px}
.skill-right{flex:1}
.skill-label-text{font-size:.82rem;color:var(--tx2);font-weight:600;margin-bottom:6px}
.skill-bar-track{height:10px;background:var(--bg4);border-radius:6px;overflow:hidden}
.skill-bar-fill{height:100%;border-radius:6px;transition:width .25s ease;
  background:linear-gradient(90deg,var(--blue3),var(--gold))}
.skill-ticks{display:flex;justify-content:space-between;margin-top:4px}
.skill-tick{font-size:.65rem;color:var(--tx2)}

/* Calendar */
.cal-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:14px}
.cal-nav{cursor:pointer;background:var(--bg4);border:1px solid var(--bd);color:var(--tx);
  border-radius:8px;width:34px;height:34px;display:flex;align-items:center;justify-content:center;
  font-size:1.2rem;transition:all .15s}
.cal-nav:hover{border-color:var(--gold);color:var(--gold)}
.cal-month-label{font-family:'Bebas Neue',sans-serif;font-size:1.2rem;letter-spacing:.06em}
.cal-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:5px}
.cal-day-name{text-align:center;font-size:.68rem;font-weight:700;color:var(--tx2);padding:5px 0;text-transform:uppercase}
.cal-cell{aspect-ratio:1;border-radius:9px;border:1.5px solid transparent;background:var(--bg4);
  display:flex;align-items:center;justify-content:center;font-size:.82rem;cursor:pointer;
  transition:all .15s;color:var(--tx);font-weight:500;user-select:none}
.cal-cell:hover:not(.disabled):not(.empty){border-color:var(--gold);color:var(--gold);background:rgba(245,158,11,.07)}
.cal-cell.selected{background:linear-gradient(135deg,var(--gold2),var(--gold));color:#000;font-weight:700;border-color:var(--gold)}
.cal-cell.today-mark:not(.selected){border-color:var(--blue3)}
.cal-cell.disabled{color:var(--bd);cursor:not-allowed;background:transparent;pointer-events:none}
.cal-cell.empty{background:transparent;cursor:default;pointer-events:none;border:none}

/* Slots */
.slot-date-section{margin-bottom:24px}
.slot-date-header{font-weight:700;font-size:.95rem;color:var(--gold);margin-bottom:12px;
  padding-bottom:8px;border-bottom:1px solid var(--bd)}
.period-block{margin-bottom:14px}
.period-header{display:flex;align-items:center;gap:8px;font-size:.82rem;font-weight:700;
  color:var(--tx2);text-transform:uppercase;letter-spacing:.06em;margin-bottom:8px;user-select:none}
.period-toggle-btn{cursor:pointer;background:none;border:none;color:var(--tx2);font-size:.8rem;
  transition:transform .2s;padding:0 2px;line-height:1;font-family:inherit}
.period-toggle-btn.open{transform:rotate(90deg)}
.period-title-span{cursor:pointer;display:flex;align-items:center;gap:5px}
.period-range{color:var(--tx2);font-size:.72rem}
.period-select-all{margin-right:auto;font-size:.72rem;color:var(--blue4);cursor:pointer;
  font-weight:600;text-decoration:underline;text-underline-offset:2px;
  background:none;border:none;font-family:'Frank Ruhl Libre',serif}
.hours-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(130px,1fr));gap:7px;margin-top:4px}
.hour-btn{display:flex;align-items:center;gap:7px;background:var(--bg4);border:1.5px solid var(--bd);
  border-radius:9px;padding:9px 13px;cursor:pointer;transition:all .15s;
  font-size:.8rem;font-weight:600;color:var(--tx);font-family:'Frank Ruhl Libre',serif;
  width:100%;text-align:right}
.hour-btn:hover{border-color:var(--gold);background:rgba(245,158,11,.06)}
.hour-btn.checked{border-color:var(--gold);background:rgba(245,158,11,.1);color:var(--gold)}
.hour-dot{width:8px;height:8px;border-radius:50%;background:var(--bd);transition:background .15s;flex-shrink:0}
.hour-btn.checked .hour-dot{background:var(--gold)}

.btn-primary{background:linear-gradient(135deg,var(--gold2),var(--gold));color:#000;
  font-family:'Frank Ruhl Libre',serif;font-weight:800;font-size:1rem;border:none;border-radius:10px;
  padding:14px 28px;cursor:pointer;transition:all .2s;width:100%}
.btn-primary:hover:not(:disabled){filter:brightness(1.1);transform:translateY(-2px);box-shadow:0 6px 24px rgba(245,158,11,.3)}
.btn-primary:disabled{opacity:.5;cursor:not-allowed;transform:none}

/* Success screen */
.success-screen{display:none;text-align:center;padding:60px 20px}
.success-screen.show{display:block}
.success-icon{font-size:4rem;margin-bottom:16px}
.success-title{font-family:'Bebas Neue',sans-serif;font-size:2.5rem;
  background:linear-gradient(135deg,var(--gold),var(--gold3));
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:10px}
.success-sub{color:var(--tx2);font-size:.95rem;margin-bottom:28px}
.btn-secondary{background:var(--bg4);color:var(--tx);border:1.5px solid var(--bd);
  font-family:'Frank Ruhl Libre',serif;font-weight:700;font-size:.9rem;border-radius:10px;
  padding:11px 24px;cursor:pointer;transition:all .2s}
.btn-secondary:hover{border-color:var(--gold);color:var(--gold)}

/* Spinner */
.spinner{display:inline-block;width:18px;height:18px;border:2px solid rgba(0,0,0,.3);
  border-top-color:#000;border-radius:50%;animation:spin .7s linear infinite;vertical-align:middle;margin-left:8px}
@keyframes spin{to{transform:rotate(360deg)}}

/* Hero */
.hero{text-align:center;padding:44px 0 32px}
.hero h1{font-size:3.5rem;line-height:1;color:var(--tx)}
.hero h1 span{background:linear-gradient(135deg,var(--gold),var(--gold3));
  -webkit-background-clip:text;-webkit-text-fill-color:transparent}
.hero p{color:var(--tx2);margin-top:10px;font-size:.95rem}
.hero-accent{display:inline-block;width:60px;height:3px;
  background:linear-gradient(90deg,var(--gold2),var(--blue3));border-radius:2px;margin:14px auto 0}

@media(max-width:500px){
  .hero h1{font-size:2.5rem}
  .hours-grid{grid-template-columns:repeat(2,1fr)}
  nav{padding:12px 16px}
}
</style>
</head>
<body>

<nav>
  <div class="nav-brand">ğŸ¾ PADEL CLUB</div>
</nav>

<div class="app">

  <!-- Hero -->
  <div class="hero" id="hero-section">
    <h1>××•×¢×“×•×Ÿ <span>×¤××“×œ</span></h1>
    <p>×¨×©×•× ××ª ×”×–××™× ×•×ª ×©×œ×š ×•×”×¦×˜×¨×£ ×œ××©×—×§ ×”×§×¨×•×‘ ×©××ª××™× ×œ×¨××ª×š</p>
    <div class="hero-accent"></div>
  </div>

  <!-- Form -->
  <div id="form-section">

    <!-- 01 Player info -->
    <div class="card">
      <div class="card-title">
        <div class="card-title-bar"></div>
        <span class="card-title-text">01 Â· ×¤×¨×˜×™ ×©×—×§×Ÿ</span>
      </div>
      <div class="form-group">
        <label class="field-label">×©× ××œ×</label>
        <input type="text" id="inp-name" placeholder="×™×©×¨××œ ×™×©×¨××œ×™"/>
        <div class="field-error" id="err-name">×©× × ×“×¨×©</div>
      </div>
      <div class="form-group">
        <label class="field-label">××¡×¤×¨ ×˜×œ×¤×•×Ÿ</label>
        <input type="tel" id="inp-phone" placeholder="05x-xxx-xxxx"/>
        <div class="field-error" id="err-phone">××¡×¤×¨ ×˜×œ×¤×•×Ÿ × ×“×¨×©</div>
      </div>
      <div class="form-group">
        <label class="field-label">×¨××ª ××©×—×§</label>
        <div class="skill-slider-wrap">
          <input type="range" class="skill-slider" id="skill-slider" min="1" max="5" step="0.1" value="3" oninput="updateSkill(this.value)"/>
          <div class="skill-display">
            <div class="skill-value" id="skill-val">3.0</div>
            <div class="skill-right">
              <div class="skill-label-text" id="skill-lbl">×‘×™× ×•× ×™</div>
              <div class="skill-bar-track"><div class="skill-bar-fill" id="skill-fill" style="width:50%"></div></div>
              <div class="skill-ticks">
                <span class="skill-tick">1</span><span class="skill-tick">2</span>
                <span class="skill-tick">3</span><span class="skill-tick">4</span><span class="skill-tick">5</span>
              </div>
            </div>
          </div>
        </div>
        <p style="color:var(--tx2);font-size:.72rem;margin-top:6px">1 = ××ª×—×™×œ Â· 2 = ××ª×—×™×œ ××ª×§×“× Â· 3 = ×‘×™× ×•× ×™ Â· 4 = ××ª×§×“× Â· 5 = ××§×¦×•×¢×™</p>
      </div>
    </div>

    <!-- 02 Calendar -->
    <div class="card">
      <div class="card-title">
        <div class="card-title-bar"></div>
        <span class="card-title-text">02 Â· ×‘×—×¨ ×ª××¨×™×›×™×</span>
      </div>
      <div id="calendar"></div>
      <div class="field-error" id="err-dates">×‘×—×¨ ×œ×¤×—×•×ª ×ª××¨×™×š ××—×“</div>
    </div>

    <!-- 03 Time slots -->
    <div class="card">
      <div class="card-title">
        <div class="card-title-bar"></div>
        <span class="card-title-text">03 Â· ×–×× ×™ ×–××™× ×•×ª</span>
      </div>
      <div id="slots-container"></div>
      <div class="field-error" id="err-slots">×‘×—×¨ ×œ×¤×—×•×ª ×©×¢×” ××—×ª</div>
    </div>

    <button class="btn-primary" id="submit-btn" onclick="submitForm()">ğŸ¾ ×©×œ×— ×–××™× ×•×ª</button>
  </div>

  <!-- Success -->
  <div class="success-screen" id="success-screen">
    <div class="success-icon">ğŸ¾</div>
    <div class="success-title">× ×¨×©××ª ×‘×”×¦×œ×—×”!</div>
    <div class="success-sub" id="success-msg"></div>
    <button class="btn-secondary" onclick="resetForm()">×¨×™×©×•× × ×•×¡×£</button>
  </div>

</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// âš™ï¸  ×”×’×“×¨×” ×™×—×™×“×” ×©×¦×¨×™×š ×œ×©× ×•×ª:
//     ×”×“×‘×§ ×›××Ÿ ××ª ×›×ª×•×‘×ª ×”-Web App ×©×œ×š ×-Google Apps Script
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const SCRIPT_URL = '1h5tIT1IsA82WoELKSVO4A_JaqpgjNZdU63KzCHxdj8c'; // ×ª×—×œ×™×£ ××—×¨×™ ×¤×¨×¡×•× Apps Script
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const MONTHS = ["January","February","March","April","May","June","July","August","September","October","November","December"];
const DAYS   = ["Su","Mo","Tu","We","Th","Fr","Sa"];
const PERIODS = [
  { id:"morning",   label:"×‘×•×§×¨",   icon:"ğŸŒ…", hours:[6,7,8,9,10,11] },
  { id:"afternoon", label:"×¦×”×¨×™×™×", icon:"â˜€ï¸", hours:[12,13,14,15,16] },
  { id:"evening",   label:"×¢×¨×‘",    icon:"ğŸŒ™", hours:[17,18,19,20,21,22] },
];
const SKILL_LABELS = {1:"××ª×—×™×œ",2:"××ª×—×™×œ ××ª×§×“×",3:"×‘×™× ×•× ×™",4:"××ª×§×“×",5:"××§×¦×•×¢×™"};

const state = {
  calYear: new Date().getFullYear(),
  calMonth: new Date().getMonth(),
  selectedDates: [],
  slots: {},
  openPeriods: { morning:true, afternoon:true, evening:true },
};

// Show config warning if URL not set


// â”€â”€ Helpers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function toKey(d) {
  return d.getFullYear()+'-'+String(d.getMonth()+1).padStart(2,'0')+'-'+String(d.getDate()).padStart(2,'0');
}
function fromKey(k) { const [y,m,d]=k.split('-').map(Number); return new Date(y,m-1,d); }
function todayMidnight() { const d=new Date(); d.setHours(0,0,0,0); return d; }
function skillLabelFor(v) { return SKILL_LABELS[Math.round(v)] || ''; }
function hid(h) { return 'h'+h; }
function hLabel(h) { return h+':00 â€“ '+(h+1)+':00'; }
function calDays(year, month) {
  const first=new Date(year,month,1), last=new Date(year,month+1,0), cells=[];
  for(let i=0;i<first.getDay();i++) cells.push(null);
  for(let d=1;d<=last.getDate();d++) cells.push(new Date(year,month,d));
  return cells;
}

// â”€â”€ Skill slider â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function updateSkill(v) {
  v = parseFloat(v);
  const pct = ((v-1)/4*100).toFixed(1);
  document.getElementById('skill-val').textContent  = v.toFixed(1);
  document.getElementById('skill-lbl').textContent  = skillLabelFor(v);
  document.getElementById('skill-fill').style.width = pct+'%';
  document.getElementById('skill-slider').style.background =
    'linear-gradient(90deg,var(--gold) '+pct+'%,var(--bg4) '+pct+'%)';
}
updateSkill(3);

// â”€â”€ Calendar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderCalendar() {
  const {calYear,calMonth,selectedDates}=state;
  const cells=calDays(calYear,calMonth);
  const now=todayMidnight(), todayKey=toKey(now);
  const maxDate=new Date(now); maxDate.setDate(maxDate.getDate()+13);
  const viewIsAtMax=(calYear>maxDate.getFullYear())||(calYear===maxDate.getFullYear()&&calMonth>=maxDate.getMonth());
  const viewIsAtMin=(calYear<now.getFullYear())||(calYear===now.getFullYear()&&calMonth<=now.getMonth());

  let html='<div class="cal-header">'+
    '<button class="cal-nav" onclick="calShift(1)" style="'+(viewIsAtMax?'opacity:.25;pointer-events:none':'')+'">â€º</button>'+
    '<span class="cal-month-label">'+MONTHS[calMonth]+' '+calYear+'</span>'+
    '<button class="cal-nav" onclick="calShift(-1)" style="'+(viewIsAtMin?'opacity:.25;pointer-events:none':'')+'">â€¹</button>'+
    '</div>';
  html+='<div style="font-size:.72rem;color:var(--tx2);margin-bottom:10px;text-align:center">'+
    '× ×™×ª×Ÿ ×œ×‘×—×•×¨ ×¢×“ '+maxDate.toLocaleDateString('he-IL',{day:'numeric',month:'long'})+' (14 ×™××™× ×§×“×™××”)</div>';
  html+='<div class="cal-grid">';
  DAYS.forEach(d=>{html+='<div class="cal-day-name">'+d+'</div>';});
  cells.forEach(d=>{
    if(!d){html+='<div class="cal-cell empty"></div>';return;}
    const k=toKey(d),isPast=d<now,isBeyond=d>maxDate,disabled=isPast||isBeyond;
    const isSel=selectedDates.includes(k),isToday=k===todayKey;
    let cls='cal-cell';
    if(disabled) cls+=' disabled';
    else if(isSel) cls+=' selected';
    else if(isToday) cls+=' today-mark';
    html+='<div class="'+cls+'"'+(disabled?'':' onclick="toggleDate(\''+k+'\')"')+'>'+d.getDate()+'</div>';
  });
  html+='</div>';
  document.getElementById('calendar').innerHTML=html;
}
function calShift(dir){
  const now=todayMidnight();
  const maxDate=new Date(now); maxDate.setDate(maxDate.getDate()+13);
  state.calMonth+=dir;
  if(state.calMonth>11){state.calMonth=0;state.calYear++;}
  if(state.calMonth<0){state.calMonth=11;state.calYear--;}
  if(state.calYear<now.getFullYear()||(state.calYear===now.getFullYear()&&state.calMonth<now.getMonth())){
    state.calYear=now.getFullYear();state.calMonth=now.getMonth();
  }
  if(state.calYear>maxDate.getFullYear()||(state.calYear===maxDate.getFullYear()&&state.calMonth>maxDate.getMonth())){
    state.calYear=maxDate.getFullYear();state.calMonth=maxDate.getMonth();
  }
  renderCalendar();
}
function toggleDate(key){
  const idx=state.selectedDates.indexOf(key);
  if(idx>=0){state.selectedDates.splice(idx,1);delete state.slots[key];}
  else{state.selectedDates.push(key);if(!state.slots[key])state.slots[key]=[];}
  renderCalendar();renderSlots();
}

// â”€â”€ Slots â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderSlots(){
  const container=document.getElementById('slots-container');
  const sorted=state.selectedDates.slice().sort();
  if(sorted.length===0){
    container.innerHTML='<p style="color:var(--tx2);font-size:.875rem;padding:8px 0">×‘×—×¨ ×ª××¨×™×›×™× ×§×•×“× ××”×œ×•×— ×©× ×”.</p>';
    return;
  }
  let html='';
  sorted.forEach(dk=>{
    const d=fromKey(dk);
    const label=d.toLocaleDateString('he-IL',{weekday:'long',day:'numeric',month:'long'});
    const active=state.slots[dk]||[];
    html+='<div class="slot-date-section"><div class="slot-date-header">ğŸ“… '+label+'</div>';
    PERIODS.forEach(period=>{
      const isOpen=state.openPeriods[period.id];
      const allChecked=period.hours.every(h=>active.indexOf(hid(h))!==-1);
      const rangeEnd=period.hours[period.hours.length-1];
      html+='<div class="period-block">'+
        '<div class="period-header">'+
        '<button class="period-toggle-btn'+(isOpen?' open':'')+'" onclick="togglePeriod(\''+period.id+'\')">â–¶</button>'+
        '<span class="period-title-span" onclick="togglePeriod(\''+period.id+'\')">'+ period.icon+' '+period.label+'</span>'+
        '<span class="period-range">'+period.hours[0]+':00 â€“ '+(rangeEnd+1)+':00</span>'+
        '<button class="period-select-all" onclick="selectAllPeriod(\''+dk+'\',\''+period.id+'\','+allChecked+')">'+(allChecked?'×‘×˜×œ ×”×›×œ':'×‘×—×¨ ×”×›×œ')+'</button>'+
        '</div>';
      if(isOpen){
        html+='<div class="hours-grid">';
        period.hours.forEach(h=>{
          const id=hid(h),checked=active.indexOf(id)!==-1;
          html+='<button class="hour-btn'+(checked?' checked':'')+'" onclick="toggleHour(\''+dk+'\',\''+id+'\')">' +
            '<div class="hour-dot"></div>'+hLabel(h)+'</button>';
        });
        html+='</div>';
      }
      html+='</div>';
    });
    html+='</div>';
  });
  container.innerHTML=html;
}
function togglePeriod(pid){state.openPeriods[pid]=!state.openPeriods[pid];renderSlots();}
function toggleHour(dk,id){
  if(!state.slots[dk])state.slots[dk]=[];
  const arr=state.slots[dk],idx=arr.indexOf(id);
  if(idx>=0)arr.splice(idx,1);else arr.push(id);
  renderSlots();
}
function selectAllPeriod(dk,pid,allChecked){
  if(!state.slots[dk])state.slots[dk]=[];
  PERIODS.find(p=>p.id===pid).hours.forEach(h=>{
    const id=hid(h),idx=state.slots[dk].indexOf(id);
    if(allChecked){if(idx>=0)state.slots[dk].splice(idx,1);}
    else{if(idx<0)state.slots[dk].push(id);}
  });
  renderSlots();
}

// â”€â”€ Submit â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function submitForm(){
  const name  = document.getElementById('inp-name').value.trim();
  const phone = document.getElementById('inp-phone').value.trim();
  const skill = parseFloat(document.getElementById('skill-slider').value);
  let valid = true;

  function setErr(id,show){
    document.getElementById(id).classList.toggle('show',show);
    if(show) valid=false;
  }
  setErr('err-name',  !name);
  setErr('err-phone', !phone);
  setErr('err-dates', state.selectedDates.length===0);
  setErr('err-slots', !state.selectedDates.some(dk=>(state.slots[dk]||[]).length>0));
  if(!valid) return;

  // Build rows: one row per date+hour combination
  const rows = [];
  state.selectedDates.sort().forEach(dk=>{
    const d = fromKey(dk);
    const dateStr = d.toLocaleDateString('he-IL',{weekday:'long',day:'numeric',month:'long',year:'numeric'});
    (state.slots[dk]||[]).sort().forEach(hourId=>{
      const h = parseInt(hourId.replace('h',''));
      rows.push({
        name, phone,
        skill: skill.toFixed(1),
        date: dk,
        dateLabel: dateStr,
        hour: hLabel(h),
        period: PERIODS.find(p=>p.hours.includes(h))?.label || '',
        submittedAt: new Date().toISOString()
      });
    });
  });

  const btn = document.getElementById('submit-btn');
  btn.disabled = true;
  btn.innerHTML = '×©×•×œ×—... <span class="spinner"></span>';

  try {
    await fetch(SCRIPT_URL, {
      method: 'POST',
      mode: 'no-cors',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify({ rows })
    });

    // Show success (no-cors means we can't read response, assume success)
    document.getElementById('form-section').style.display='none';
    document.getElementById('hero-section').style.display='none';
    const totalHours = state.selectedDates.reduce((s,dk)=>s+(state.slots[dk]||[]).length,0);
    document.getElementById('success-msg').textContent =
      '×©×œ×•× '+name+'! ×¨×©×× ×• ××•×ª×š ×œ-'+totalHours+' ×©×¢×•×ª ×‘-'+state.selectedDates.length+' ×™××™× ğŸ¾';
    document.getElementById('success-screen').classList.add('show');

  } catch(e) {
    btn.disabled = false;
    btn.innerHTML = 'ğŸ¾ ×©×œ×— ×–××™× ×•×ª';
    alert('×©×’×™××” ×‘×©×œ×™×—×”. ×‘×“×•×§ ××ª ×”×—×™×‘×•×¨ ×œ××™× ×˜×¨× ×˜ ×•× ×¡×” ×©×•×‘.');
  }
}

function resetForm(){
  document.getElementById('inp-name').value='';
  document.getElementById('inp-phone').value='';
  updateSkill(3);
  document.getElementById('skill-slider').value=3;
  state.selectedDates=[];state.slots={};
  renderCalendar();renderSlots();
  document.getElementById('form-section').style.display='';
  document.getElementById('hero-section').style.display='';
  document.getElementById('success-screen').classList.remove('show');
  document.getElementById('submit-btn').disabled=false;
  document.getElementById('submit-btn').innerHTML='ğŸ¾ ×©×œ×— ×–××™× ×•×ª';
}

// â”€â”€ Boot â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
renderCalendar();
renderSlots();
</script>
</body>
</html>
